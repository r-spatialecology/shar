<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="shar">
<title>Multi-trait point pattern reconstruction of plant ecosystems • shar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-trait point pattern reconstruction of plant ecosystems">
<meta property="og:description" content="shar">
<meta property="og:image" content="https://r-spatialecology.github.io/shar/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">shar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/get_started.html">
    <span class="fa fa fa fa-magic"></span>
     
    Get Started
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-gears"></span>
     
    Functions
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/background.html">
    <span class="fa fa-book"></span>
     
    General Background
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--more">
    <span class="fa fa-graduation-cap"></span>
     
    More
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--more">
    <a class="dropdown-item" href="../articles/parallelization.html">
      <span class="fa fa-book"></span>
       
      Parallelization
    </a>
    <a class="dropdown-item" href="../articles/reconstruct_several_patterns.html">
      <span class="fa fa-book"></span>
       
      Reconstruct several patterns
    </a>
    <a class="dropdown-item" href="../articles/reconstruct_multi_patterns.html">
      <span class="fa fa-book"></span>
       
      Multi-trait pattern reconstruction
    </a>
    <a class="dropdown-item" href="../articles/cormus_domestica_tmp.html">
      <span class="fa fa-book"></span>
       
      Analysing the climatic niche of Cormus domestica
    </a>
    <a class="dropdown-item" href="../articles/publication_record.html">
      <span class="fa fa-file-text-o"></span>
       
      Publication Record
    </a>
    <a class="external-link dropdown-item" href="https://doi.org/10.21105/joss.03811">
      <span class="fa fa-file-text-o"></span>
       
      JOSS Publication
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-spatialecology/shar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.maxhesselbarth.com">
    <span class="fa fa-user"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multi-trait point pattern reconstruction of plant ecosystems</h1>
                        <h4 data-toc-skip class="author"></h4>
            
            <h4 data-toc-skip class="date">2023-12-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatialecology/shar/blob/HEAD/vignettes/articles/reconstruct_multi_patterns.Rmd" class="external-link"><code>vignettes/articles/reconstruct_multi_patterns.Rmd</code></a></small>
      <div class="d-none name"><code>reconstruct_multi_patterns.Rmd</code></div>
    </div>

    
    
<p>…Work-in progress…</p>
<p>If you want more information about multi-trait point pattern
reconstruction, please refer to the <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.14206" class="external-link">corresponding
paper</a>.</p>
<p>If you wish to include several marks simultaneously in a
reconstruction, you can use the following code. The libraries used must
first be loaded.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatialecology.github.io/shar/">shar</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://spatstat.org/" class="external-link">spatstat</a></span><span class="op">)</span></span></code></pre></div>
<p>The next step is to load the point pattern, here is an example of a
random point pattern with several marks to show the structure of the
data used.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xr</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">yr</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">400</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="va">yr</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="va">xr</span><span class="op">)</span></span>
<span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span>, <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">diameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="va">random</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, dbh <span class="op">=</span> <span class="va">diameter</span>, species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">marked_pattern</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/as.ppp.html" class="external-link">as.ppp</a></span><span class="op">(</span><span class="va">random</span>, W <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/owin.html" class="external-link">owin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">xr</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">yr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>    </span></code></pre></div>
<p>The point pattern must contain the following data An x and y
coordinate, a metric mark (in metres) and a nominal mark defined as a
factor. The order must be respected. Now the reconstruction with several
marks can be started with the following code. Note that the maximum
number of iterations has been set to max_steps = 10000 to keep the
computation time for this example to a minimum. For an application, this
value should be increased according to the number of points in the
pattern.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reconstruction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct_pattern_multi.html">reconstruct_pattern_multi</a></span><span class="op">(</span></span>
<span><span class="va">marked_pattern</span>, </span>
<span>n_repetitions <span class="op">=</span> <span class="fl">1</span>,</span>
<span>max_steps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
&gt; Progress:  || iterations: 0 || Simulation progress: 0% || energy = 0.02043 || energy improvement = 0      

&gt; Progress:  || iterations: 1000 || Simulation progress: 10% || energy = 0.00045 || energy improvement = 236        

&gt; Progress:  || iterations: 2000 || Simulation progress: 20% || energy = 0.00032 || energy improvement = 339        

&gt; Progress:  || iterations: 3000 || Simulation progress: 30% || energy = 0.00028 || energy improvement = 407        

&gt; Progress:  || iterations: 4000 || Simulation progress: 40% || energy = 0.00028 || energy improvement = 454        

&gt; Progress:  || iterations: 5000 || Simulation progress: 50% || energy = 0.00027 || energy improvement = 493        

&gt; Progress:  || iterations: 6000 || Simulation progress: 60% || energy = 0.00026 || energy improvement = 539        

&gt; Progress:  || iterations: 7000 || Simulation progress: 70% || energy = 0.00025 || energy improvement = 587        

&gt; Progress:  || iterations: 8000 || Simulation progress: 80% || energy = 0.00025 || energy improvement = 628        

&gt; Progress:  || iterations: 9000 || Simulation progress: 90% || energy = 0.00025 || energy improvement = 657        

&gt; Progress:  || iterations: 10000 || Simulation progress: 100% || energy = 0.00025 || energy improvement = 682      </code></pre>
<p>As a result, you will receive a list containing a variety of
information, for example, the reference pattern, the reconstructed
pattern, the number of successful actions, the energy development and
much more. If you wish to perform several reconstructions of the same
reference pattern, you must increase n_repetitions to the desired
number.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reconstruction_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct_pattern_multi.html">reconstruct_pattern_multi</a></span><span class="op">(</span></span>
<span><span class="va">marked_pattern</span>, </span>
<span>n_repetitions <span class="op">=</span> <span class="fl">2</span>,</span>
<span>max_steps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
&gt; Progress: reconstruction_1 || iterations: 0 || Simulation progress: 0% || energy = 0.00309 || energy improvement = 0      

&gt; Progress: reconstruction_1 || iterations: 1000 || Simulation progress: 10% || energy = 0.00038 || energy improvement = 221        

&gt; Progress: reconstruction_1 || iterations: 2000 || Simulation progress: 20% || energy = 0.00031 || energy improvement = 308        

&gt; Progress: reconstruction_1 || iterations: 3000 || Simulation progress: 30% || energy = 0.00027 || energy improvement = 381        

&gt; Progress: reconstruction_1 || iterations: 4000 || Simulation progress: 40% || energy = 0.00024 || energy improvement = 437        

&gt; Progress: reconstruction_1 || iterations: 5000 || Simulation progress: 50% || energy = 0.00023 || energy improvement = 487        

&gt; Progress: reconstruction_1 || iterations: 6000 || Simulation progress: 60% || energy = 0.00022 || energy improvement = 528        

&gt; Progress: reconstruction_1 || iterations: 7000 || Simulation progress: 70% || energy = 0.00022 || energy improvement = 562        

&gt; Progress: reconstruction_1 || iterations: 8000 || Simulation progress: 80% || energy = 0.00022 || energy improvement = 592        

&gt; Progress: reconstruction_1 || iterations: 9000 || Simulation progress: 90% || energy = 0.00021 || energy improvement = 615        

&gt; Progress: reconstruction_1 || iterations: 10000 || Simulation progress: 100% || energy = 2e-04 || energy improvement = 646        
## 
## 
&gt; Progress: reconstruction_2 || iterations: 0 || Simulation progress: 0% || energy = 0.03411 || energy improvement = 0      

&gt; Progress: reconstruction_2 || iterations: 1000 || Simulation progress: 10% || energy = 0.00049 || energy improvement = 225        

&gt; Progress: reconstruction_2 || iterations: 2000 || Simulation progress: 20% || energy = 0.00036 || energy improvement = 332        

&gt; Progress: reconstruction_2 || iterations: 3000 || Simulation progress: 30% || energy = 0.00029 || energy improvement = 406        

&gt; Progress: reconstruction_2 || iterations: 4000 || Simulation progress: 40% || energy = 0.00026 || energy improvement = 464        

&gt; Progress: reconstruction_2 || iterations: 5000 || Simulation progress: 50% || energy = 0.00025 || energy improvement = 507        

&gt; Progress: reconstruction_2 || iterations: 6000 || Simulation progress: 60% || energy = 0.00024 || energy improvement = 550        

&gt; Progress: reconstruction_2 || iterations: 7000 || Simulation progress: 70% || energy = 0.00024 || energy improvement = 603        

&gt; Progress: reconstruction_2 || iterations: 8000 || Simulation progress: 80% || energy = 0.00023 || energy improvement = 635        

&gt; Progress: reconstruction_2 || iterations: 9000 || Simulation progress: 90% || energy = 0.00023 || energy improvement = 659        

&gt; Progress: reconstruction_2 || iterations: 10000 || Simulation progress: 100% || energy = 0.00023 || energy improvement = 686      </code></pre>
<p>To activate a visualisation of the reconstruction that shows the
changes in the pattern at the relevant time, you must proceed as
follows.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reconstruction_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct_pattern_multi.html">reconstruct_pattern_multi</a></span><span class="op">(</span></span>
<span><span class="va">marked_pattern</span>, </span>
<span>n_repetitions <span class="op">=</span> <span class="fl">1</span>,</span>
<span>max_steps <span class="op">=</span> <span class="fl">10000</span>, </span>
<span>plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
&gt; Progress:  || iterations: 0 || Simulation progress: 0% || energy = 0.23334 || energy improvement = 0      

&gt; Progress:  || iterations: 1000 || Simulation progress: 10% || energy = 0.00057 || energy improvement = 303        

&gt; Progress:  || iterations: 2000 || Simulation progress: 20% || energy = 0.00047 || energy improvement = 404        

&gt; Progress:  || iterations: 3000 || Simulation progress: 30% || energy = 0.00044 || energy improvement = 479        

&gt; Progress:  || iterations: 4000 || Simulation progress: 40% || energy = 0.00043 || energy improvement = 538        

&gt; Progress:  || iterations: 5000 || Simulation progress: 50% || energy = 0.00041 || energy improvement = 590        

&gt; Progress:  || iterations: 6000 || Simulation progress: 60% || energy = 0.00041 || energy improvement = 632        

&gt; Progress:  || iterations: 7000 || Simulation progress: 70% || energy = 4e-04 || energy improvement = 669      

&gt; Progress:  || iterations: 8000 || Simulation progress: 80% || energy = 4e-04 || energy improvement = 695      

&gt; Progress:  || iterations: 9000 || Simulation progress: 90% || energy = 4e-04 || energy improvement = 726      

&gt; Progress:  || iterations: 10000 || Simulation progress: 100% || energy = 4e-04 || energy improvement = 752        </code></pre>
<p><img src="reconstruct_multi_patterns_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Finally, you can use the following function to view different summary
statistics of the reference pattern (black line) compared to the
reconstructed pattern (grey line). For this, however, the listed
libraries must be loaded additionally.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">reconstruction</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Progress in the creation of the figures: 100%</span></span></code></pre>
<p><img src="reconstruct_multi_patterns_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Maximilian H.K. Hesselbarth, Marco Sciaini, Chris Wudel.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
