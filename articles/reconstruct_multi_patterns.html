<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Multi-trait point pattern reconstruction of plant ecosystems • shar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-trait point pattern reconstruction of plant ecosystems">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/get_started.html"><span class="fa fa-magic"></span> Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-gears"></span> Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/background.html"><span class="fa fa-book"></span> General Background</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-graduation-cap"></span> More</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-more">
<li><a class="dropdown-item" href="../articles/parallelization.html"><span class="fa fa-book"></span> Parallelization</a></li>
    <li><a class="dropdown-item" href="../articles/reconstruct_several_patterns.html"><span class="fa fa-book"></span> Reconstruct several patterns</a></li>
    <li><a class="dropdown-item" href="../articles/reconstruct_multi_patterns.html"><span class="fa fa-book"></span> Multi-trait pattern reconstruction</a></li>
    <li><a class="dropdown-item" href="../articles/cormus_domestica_tmp.html"><span class="fa fa-book"></span> Analysing the climatic niche of Cormus domestica</a></li>
    <li><a class="dropdown-item" href="../articles/publication_record.html"><span class="fa fa-file-text-o"></span> Publication Record</a></li>
    <li><a class="external-link dropdown-item" href="https://doi.org/10.21105/joss.03811"><span class="fa fa-file-text-o"></span> JOSS Publication</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatialecology/shar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.maxhesselbarth.com"><span class="fa fa-user"></span></a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multi-trait point pattern reconstruction of plant ecosystems</h1>
                        <h4 data-toc-skip class="author"></h4>
            
            <h4 data-toc-skip class="date">2025-01-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatialecology/shar/blob/main/vignettes/articles/reconstruct_multi_patterns.Rmd" class="external-link"><code>vignettes/articles/reconstruct_multi_patterns.Rmd</code></a></small>
      <div class="d-none name"><code>reconstruct_multi_patterns.Rmd</code></div>
    </div>

    
    
<p>…Work-in progress…</p>
<p>If you want more information about multi-trait point pattern
reconstruction, please refer to the <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.14206" class="external-link">corresponding
paper</a>.</p>
<p>If you wish to include several marks simultaneously in a
reconstruction, you can use the following code. The libraries used must
first be loaded.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatialecology.github.io/shar/">shar</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://spatstat.org/" class="external-link">spatstat</a></span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Please note that the maximum number of iterations has been set to
<code>max_steps = 10000</code> and
<code>n_repetitions = 1</code>/<code>n_repetitions = 3</code> to keep
computational time low for this example. For real-world applications, it
is advisable to raise these values.</p>
</blockquote>
<p>The next step is to load the point pattern, here is an example of a
random point pattern with several marks to show the structure of the
data used.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xr</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">yr</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">400</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="va">yr</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="va">xr</span><span class="op">)</span></span>
<span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span>, <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">diameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="va">random</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, dbh <span class="op">=</span> <span class="va">diameter</span>, species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">marked_pattern</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/as.ppp.html" class="external-link">as.ppp</a></span><span class="op">(</span><span class="va">random</span>, W <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/owin.html" class="external-link">owin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">xr</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">yr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>    </span></code></pre></div>
<p>The point pattern must contain the following data An x and y
coordinate, a metric mark (in metres) and a nominal mark defined as a
factor. The order must be respected. Now the reconstruction with several
marks can be started with the following code. Note that the maximum
number of iterations has been set to max_steps = 10000 to keep the
computation time for this example to a minimum. For an application, this
value should be increased according to the number of points in the
pattern.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reconstruction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct_pattern_multi.html">reconstruct_pattern_multi</a></span><span class="op">(</span><span class="va">marked_pattern</span>, n_repetitions <span class="op">=</span> <span class="fl">1</span>, max_steps <span class="op">=</span> <span class="fl">10000</span>, issue <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &gt; Progress:  || iterations: 0 || Simulation progress: 0% || energy = 0.04961 || energy improvement = 0       &gt; Progress:  || iterations: 5000 || Simulation progress: 50% || energy = 0.00078 || energy improvement = 511        &gt; Progress:  || iterations: 10000 || Simulation progress: 100% || energy = 0.00077 || energy improvement = 686      </span></span></code></pre>
<p>As a result, you will receive a list containing a variety of
information, for example, the reference pattern, the reconstructed
pattern, the number of successful actions, the energy development and
much more. If you wish to perform several reconstructions of the same
reference pattern, you must increase n_repetitions to the desired
number.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reconstruction_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct_pattern_multi.html">reconstruct_pattern_multi</a></span><span class="op">(</span><span class="va">marked_pattern</span>, n_repetitions <span class="op">=</span> <span class="fl">3</span>, max_steps <span class="op">=</span> <span class="fl">10000</span>, issue <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &gt; Progress: reconstruction_1 || iterations: 0 || Simulation progress: 0% || energy = 0.0319 || energy improvement = 0        &gt; Progress: reconstruction_1 || iterations: 5000 || Simulation progress: 50% || energy = 0.00028 || energy improvement = 525        &gt; Progress: reconstruction_1 || iterations: 10000 || Simulation progress: 100% || energy = 0.00026 || energy improvement = 731      </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## &gt; Progress: reconstruction_2 || iterations: 0 || Simulation progress: 0% || energy = 0.00399 || energy improvement = 0       &gt; Progress: reconstruction_2 || iterations: 5000 || Simulation progress: 50% || energy = 0.00091 || energy improvement = 442        &gt; Progress: reconstruction_2 || iterations: 10000 || Simulation progress: 100% || energy = 0.00089 || energy improvement = 620      </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## &gt; Progress: reconstruction_3 || iterations: 0 || Simulation progress: 0% || energy = 0.11049 || energy improvement = 0       &gt; Progress: reconstruction_3 || iterations: 5000 || Simulation progress: 50% || energy = 5e-04 || energy improvement = 495      &gt; Progress: reconstruction_3 || iterations: 10000 || Simulation progress: 100% || energy = 5e-04 || energy improvement = 640        </span></span></code></pre>
<p>To activate a visualisation of the reconstruction that shows the
changes in the pattern at the relevant time, you must proceed as
follows.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reconstruction_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct_pattern_multi.html">reconstruct_pattern_multi</a></span><span class="op">(</span><span class="va">marked_pattern</span>, n_repetitions <span class="op">=</span> <span class="fl">1</span>, max_steps <span class="op">=</span> <span class="fl">10000</span>, issue <span class="op">=</span> <span class="fl">5000</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &gt; Progress: || iterations: 0 || Simulation progress: 0% || energy = 0.11639 ||</span></span>
<span><span class="co">## energy improvement = 0 &gt; Progress: || iterations: 5000 || Simulation progress:</span></span>
<span><span class="co">## 50% || energy = 0.00031 || energy improvement = 597</span></span></code></pre>
<p><img src="reconstruct_multi_patterns_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<pre><code><span><span class="co">## &gt; Progress:  || iterations: 10000 || Simulation progress: 100% || energy = 0.00029 || energy improvement = 761       </span></span></code></pre>
<p>Finally, you can use the <code><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot()</a></code> function to view
different summary statistics of the reference pattern (dashed line)
compared to the reconstructed pattern (solid line).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">reconstruction</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reconstruct_multi_patterns_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maximilian H.K. Hesselbarth, Marco Sciaini, Chris Wudel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
