<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="shar">
<title>Get started • shar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="shar">
<meta property="og:image" content="https://r-spatialecology.github.io/shar/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">shar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/get_started.html">
    <span class="fa fa fa fa-magic"></span>
     
    Get Started
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-gears"></span>
     
    Functions
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/background.html">
    <span class="fa fa-book"></span>
     
    General Background
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--more">
    <span class="fa fa-graduation-cap"></span>
     
    More
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--more">
    <a class="dropdown-item" href="../articles/reconstruct_multiple_patterns.html">
      <span class="fa fa-book"></span>
       
      Reconstruct multiple pattern
    </a>
    <a class="dropdown-item" href="../articles/parallelization.html">
      <span class="fa fa-book"></span>
       
      Parallelization
    </a>
    <a class="dropdown-item" href="../articles/cormus_domestica_tmp.html">
      <span class="fa fa-book"></span>
       
      Analysing the climatic niche of Cormus domestica
    </a>
    <a class="dropdown-item" href="../articles/publication_record.html">
      <span class="fa fa-file-text-o"></span>
       
      Publication Record
    </a>
    <a class="dropdown-item" href="../inst/Hesselbarth_2021_Journal_of_Open_Source_Software_6_68.pdf">
      <span class="fa fa-file-text-o"></span>
       
      JOSS Publication
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-spatialecology/shar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://mhesselbarth.rbind.io">
    <span class="fa fa-user"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get started</h1>
                        <h4 data-toc-skip class="author">Maximilian H.K. Hesselbarth</h4>
            
            <h4 data-toc-skip class="date">2022-09-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatialecology/shar/blob/HEAD/vignettes/get_started.Rmd" class="external-link"><code>vignettes/get_started.Rmd</code></a></small>
      <div class="d-none name"><code>get_started.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatialecology.github.io/shar/">shar</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://spatstat.org/" class="external-link">spatstat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/" class="external-link">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="design">Design<a class="anchor" aria-label="anchor" href="#design"></a>
</h2>
<p>The core of <strong>shar</strong> are functions to to simulate null model data by randomizing either the environmental data (i.e. raster data) or the locations of species (i.e. point pattern data). The null data is then used to analyse if significant species-habitat associations are present. Additionally, functions to visualize and analyse the results are available as well as some utility functions. The methods are mainly described in Harms et al. (2001), Plotkin et al. (2000) and Wiegand &amp; Moloney (2014). The methods are not necessary complementary, but are rather different approaches for the same result.</p>
</div>
<div class="section level2">
<h2 id="preprocessing-of-input-data">Preprocessing of input data<a class="anchor" aria-label="anchor" href="#preprocessing-of-input-data"></a>
</h2>
<p>All functions are designed for discrete habitat classes. Following, in case only continuous data is available, this has to be classified to discrete classes. <code>classify_habitats</code> provides several ways to classify the data such as the Fisher-Jenks algorithm (Fisher 1958, Jenks &amp; Caspall 1971)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">landscape_discrete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify_habitats.html">classify_habitats</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">landscape</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">5</span>, style <span class="op">=</span> <span class="st">"fisher"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="randomize-environmental-data">Randomize environmental data<a class="anchor" aria-label="anchor" href="#randomize-environmental-data"></a>
</h2>
<p>There are two functions to randomize the environmental data: <code><a href="../reference/translate_raster.html">translate_raster()</a></code> and <code><a href="../reference/randomize_raster.html">randomize_raster()</a></code>. The first function is a torus translation of the raster, shifting the habitat map in all four cardinal directions. This is only possible for rectangular observation areas and results in <code>n_random &lt;- (terra::nrow(terra::rast(landscape)) + 1) * (terra::ncol(terra::rast(landscape)) + 1)  - 4</code> randomized rasters. The other function randomizes the environmental data using a random-walk algorithm. Here, the number of randomized rasters can be specified using the <code>n_random</code> argument.</p>
<p>However, all methods require “fully mapped data” in a sense that NA cells of the environmental data are allowed only if simultaneously these areas cannot accommodate any locations of the point pattern (e.g., a water body within a forest area). This needs to be reflected in the observation window of the point pattern. For the torus translation method, no NA values are allowed at all.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">torus_trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/translate_raster.html">translate_raster</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">landscape_discrete</span><span class="op">)</span></span>
<span></span>
<span><span class="va">random_walk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/randomize_raster.html">randomize_raster</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">landscape_discrete</span>, n_random <span class="op">=</span> <span class="fl">39</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="randomize-location-data">Randomize location data<a class="anchor" aria-label="anchor" href="#randomize-location-data"></a>
</h2>
<p>To randomize the location data (i.e. the point pattern) either <code><a href="../reference/fit_point_process.html">fit_point_process()</a></code> or <code><a href="../reference/reconstruct_pattern.html">reconstruct_pattern()</a></code> are available. The first fits either a Poisson process or a cluster process to the data. The difference to solutions from the <code>spatstat</code> package is that the number of points is always identical. The second functions reconstructs the spatial characteristics of the data using pattern reconstruction (Tscheschel &amp; Stoyan 2006). This is advantageous for point patterns not describable by simple point process models. For both function, the number of patterns can be specified by the <code>n_random</code> argument.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gamma_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_point_process.html">fit_point_process</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="va">species_b</span>, process <span class="op">=</span> <span class="st">"cluster"</span>, n_random <span class="op">=</span> <span class="fl">39</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (this can takes some time)</span></span>
<span><span class="va">reconstruction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reconstruct_pattern.html">reconstruct_pattern</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="va">species_b</span>, n_random <span class="op">=</span> <span class="fl">39</span>, </span>
<span>                                      e_threshold <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analyse-results">Analyse results<a class="anchor" aria-label="anchor" href="#analyse-results"></a>
</h2>
<p>The most important function to analyse results is <code><a href="../reference/results_habitat_association.html">results_habitat_association()</a></code>. This function compares the observed data to the null model data and by that is able to show significant species-habitat associations. The functions work for both, randomized environmental data or randomized location data.</p>
<p>Please be aware that due to the randomization of the null model data, results might slightly differ between different randomization approaches (e.g., <code><a href="../reference/fit_point_process.html">fit_point_process()</a></code> vs. <code><a href="../reference/translate_raster.html">translate_raster()</a></code>) and even for repetitions of the same approach. However, the counts of the observed data should be identical, and general results and trends should be similar.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/results_habitat_association.html">results_habitat_association</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="va">species_a</span>, raster <span class="op">=</span> <span class="va">random_walk</span><span class="op">)</span></span>
<span><span class="co">#&gt; &gt; Input: randomized raster</span></span>
<span><span class="co">#&gt; &gt; Quantile thresholds: negative &lt; 0.025 || positive &gt; 0.975</span></span>
<span><span class="co">#&gt;   habitat breaks count    lo    hi significance</span></span>
<span><span class="co">#&gt; 1       1     NA    35 11.00 30.20     positive</span></span>
<span><span class="co">#&gt; 2       2     NA    44 23.70 49.05         n.s.</span></span>
<span><span class="co">#&gt; 3       3     NA    36 21.75 49.05         n.s.</span></span>
<span><span class="co">#&gt; 4       4     NA     4 24.80 59.05     negative</span></span>
<span><span class="co">#&gt; 5       5     NA    73 51.95 77.05         n.s.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/results_habitat_association.html">results_habitat_association</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="va">reconstruction</span>, raster <span class="op">=</span> <span class="va">landscape_discrete</span><span class="op">)</span></span>
<span><span class="co">#&gt; &gt; Input: randomized pattern</span></span>
<span><span class="co">#&gt; &gt; Quantile thresholds: negative &lt; 0.025 || positive &gt; 0.975</span></span>
<span><span class="co">#&gt;   habitat breaks count    lo    hi significance</span></span>
<span><span class="co">#&gt; 1       1     NA     6  2.95 11.15         n.s.</span></span>
<span><span class="co">#&gt; 2       2     NA    18 19.85 51.30     negative</span></span>
<span><span class="co">#&gt; 3       3     NA    18 33.95 58.00     negative</span></span>
<span><span class="co">#&gt; 4       4     NA    21 36.90 54.05     negative</span></span>
<span><span class="co">#&gt; 5       5     NA   129 38.90 76.50     positive</span></span></code></pre></div>
<p>There is also the possibility to visualize the randomized data using the <code><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">random_walk</span><span class="op">)</span></span></code></pre></div>
<p><img src="get_started_files/figure-html/plotting-1.png" width="100%" height="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">reconstruction</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="get_started_files/figure-html/plotting-2.png" width="100%" height="100%" style="display: block; margin: auto;"><img src="get_started_files/figure-html/plotting-3.png" width="100%" height="100%" style="display: block; margin: auto;"></p>
<p>For the randomized point pattern data, it is also possible to show the “difference” in terms of the energy (Tscheschel &amp; Stoyan 2006) between the patterns.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_energy.html">calculate_energy</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="va">gamma_test</span>, return_mean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1312198</span></span>
<span></span>
<span><span class="fu"><a href="../reference/calculate_energy.html">calculate_energy</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="va">reconstruction</span>, return_mean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.04907375</span></span></code></pre></div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Fisher, W.D., 1958. On grouping for maximum homogeneity. Journal of the American Statistical Association 53, 789–798. <a href="https://doi.org/10.1080/01621459.1958.10501479" class="external-link uri">https://doi.org/10.1080/01621459.1958.10501479</a></p>
<p>Harms, K.E., Condit, R., Hubbell, S.P., Foster, R.B., 2001. Habitat associations of trees and shrubs in a 50-ha neotropical forest plot. Journal of Ecology 89, 947–959. <a href="https://doi.org/10.1111/j.1365-2745.2001.00615.x" class="external-link uri">https://doi.org/10.1111/j.1365-2745.2001.00615.x</a></p>
<p>Jenks, G.F., Caspall, F.C., 1971. Error in choroplethic maps: Definition, measurement, reduction. Annals of the Association of American Geographers 61, 217–244. <a href="https://doi.org/10.1111/j.1467-8306.1971.tb00779.x" class="external-link uri">https://doi.org/10.1111/j.1467-8306.1971.tb00779.x</a></p>
<p>Plotkin, J.B., Potts, M.D., Leslie, N., Manokaran, N., LaFrankie, J.V., Ashton, P.S., 2000. Species-area curves, spatial aggregation, and habitat specialization in tropical forests. Journal of Theoretical Biology 207, 81–99. <a href="https://doi.org/10.1006/jtbi.2000.2158" class="external-link uri">https://doi.org/10.1006/jtbi.2000.2158</a></p>
<p>Tscheschel, A., Stoyan, D., 2006. Statistical reconstruction of random point patterns. Computational Statistics and Data Analysis 51, 859–871. <a href="https://doi.org/10.1016/j.csda.2005.09.007" class="external-link uri">https://doi.org/10.1016/j.csda.2005.09.007</a></p>
<p>Wiegand, T., Moloney, K.A., 2014. Handbook of spatial point-pattern analysis in ecology. Chapman and Hall/CRC Press, Boca Raton. ISBN 978-1-4200-8254-8</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Maximillian H.K. Hesselbarth, Marco Sciaini.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
